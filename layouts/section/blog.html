{{ define "main" }}
<main class="main">
  <!-- Main blog landing page layout -->
  <div class="writeups-container">
    <!-- Main content area -->
    <div class="writeups-main">
      <article class="post-single">
        <header class="post-header">
          <h1 class="post-title">{{ .Title }}</h1>
          {{ with .Params.description }}<div class="post-description">{{ . }}</div>{{ end }}
          
          <!-- RSS Button for Blog - Full width below title -->
          <div class="rss-button-fullwidth-container">
            <a href="{{ .RelPermalink }}index.xml" class="rss-button-fullwidth" title="Subscribe to {{ .Title }} RSS feed">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M4 11a9 9 0 0 1 9 9"></path>
                <path d="M4 4a16 16 0 0 1 16 16"></path>
                <circle cx="5" cy="19" r="1"></circle>
              </svg>
              RSS Feed
            </a>
          </div>
        </header>
        <div class="post-content">
          {{ .Content }}
        </div>
      </article>

      {{ $all := .RegularPages.ByDate.Reverse }}

      <!-- Latest Posts Cards Section - Moved to bottom -->
      <section class="latest-posts-bottom">
        <h2>Latest Posts</h2>
        <div class="latest-posts-cards">
          {{ range first 3 $all }}
            {{ $page := . }}
            <a href="{{ .RelPermalink }}">
              <article class="bottom-post-card">
                {{ with .Params.cover.image }}
                  <figure class="bottom-card-cover">
                    {{ if hasPrefix . "https" }}
                      <img src="{{ . }}" alt="{{ $page.Params.cover.alt }}">
                    {{ else }}
                      {{ $image := $page.Resources.Get . }}
                      {{ if $image }}
                        <img src="{{ $image.RelPermalink }}" alt="{{ $page.Params.cover.alt }}">
                      {{ else }}
                        <img src="{{ printf "%s%s" $page.RelPermalink . }}" alt="{{ $page.Params.cover.alt }}">
                      {{ end }}
                    {{ end }}
                  </figure>
                {{ end }}
                <div class="bottom-card-content">
                  <header class="bottom-card-header">
                    <h3>{{ .Title }}</h3>
                  </header>
                  <div class="bottom-card-summary">
                    <p>{{ .Summary | truncate 120 }}</p>
                  </div>
                  <footer class="bottom-card-footer">
                    <span class="date">{{ .Date.Format "Jan 2, 2006" }}</span>
                  </footer>
                </div>
              </article>
            </a>
          {{ end }}
        </div>
      </section>
    </div>

    <!-- Sidebar with all blogs list -->
    <aside class="writeups-sidebar">
      <div class="categories-widget">
        <h3>All Blogs</h3>
        <div class="all-blogs-list">
          <ul>
            {{ range $all }}
              <li class="blog-list-item">
                <a href="{{ .RelPermalink }}" class="blog-link">{{ .Title }}</a>
                <span class="blog-date">{{ .Date.Format "2006-01-02" }}</span>
              </li>
            {{ end }}
          </ul>
        </div>
      </div>
    </aside>
  </div>
</main>
{{ end }}
